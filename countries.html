<!doctype html>
<html>
<head>
    <title>My Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/jquery.mobile-1.4.5.min.css">
    <script src="js/jquery-1.11.3.min.js"></script>
    <script src="js/jquery.mobile-1.4.5.min.js"></script>
    <script type="text/javascript" src="js/page2.js"></script>
    <script type="text/javascript">


var listObject = {
    id : null
}

$(document).on('pagebeforeshow', '#landingpage', function(){       
    $(document).on('click', '#change-page-button', function(){     
        // store some data
        storeObject.id = '1234';
        storeObject.lastname = 'Afghanistan';




        //Change page
        $.mobile.changePage("#country");
    });    
});

$(document).on('pagebeforeshow', '#country', function(){     
    console.log('The selected country is ' + listObject.id );
// $('#countryname').val("AFG");
});

// Store object
var storeObject = {
    id : '',
    name : ''
}

    </script>
</head>
<body>
    <div data-role="page" id="landingpage">
        <div data-role="header" data-theme="b">
            <h1>Displaced Populations Statistics 2015</h1>
        </div><!-- /header -->
        <div data-role="content">
            <p>Please select an asylum country from the list:</p>
            <div data-role="content">
            <a href="#" data-role="button" id="change-page-button">Open next page to see a result</a>
            <br>
                <ul data-role="listview" data-inset="true" data-filter="true" id="countryList"></ul>
            </div>
        </div><!-- /content --> 
        <div data-role="footer">
            <h4>My Footer</h4>
            <div data-role="navbar">
                <ul>
                    <li><a href="#landingpage"  data-role="button">HOME</a></li>
                    <li><a href="#page2"  data-role="button">page2</a></li>
                    <li><a href="#page3"  data-role="button">page3</a></li>
                    <li><a href="#page4"  data-role="button">page4</a></li>
                </ul>
            </div>
        </div><!-- /footer -->
    </div>
    <!-- country page -->

    <div data-role="page" id="country">
        <div data-role="header" data-theme="b">
            <h1>Displaced Populations Statistics 2015</h1>
        </div><!-- /header -->
        <div data-role="content">
            <h1 id="countryname">...</h1>
            <div data-role="content">
hello
            </div>
        </div><!-- /content --> 
        <div data-role="footer">
            <h4>My Footer</h4>
            <div data-role="navbar">
                <ul>
                    <li><a href="#landingpage"  data-role="button">HOME</a></li>
                    <li><a href="#page2"  data-role="button">page2</a></li>
                    <li><a href="#page3"  data-role="button">page3</a></li>
                    <li><a href="#page4"  data-role="button">page4</a></li>
                </ul>
            </div>
        </div><!-- /footer -->
    </div>
</body>
<script type="text/javascript">
    $(document).ready(function(){
        var output = '';
        $.each(data, function (index, value) {
            output += '<li><a href="#" id='+value.id+'>' + value.name + '</a></li>';
        });
        $('#countryList').html(output).listview("refresh");
        console.log("hello");


  $('#countryList li a').each(function(){
        var elementID = $(this).attr('id');      
        $(document).on('click', '#'+elementID, function(event){  
            console.log("function"+elementID);
            if(event.handled !== true) // This will prevent event triggering more then once
            {
                listObject.id = elementID; // Save li id into an object, localstorage can also be used, find more about it here: http://stackoverflow.com/questions/14468659/jquery-mobile-document-ready-vs-page-events
                $.mobile.changePage( "#country");
                event.handled = true;
            }              
        });
    });


    });

</script>
</html>